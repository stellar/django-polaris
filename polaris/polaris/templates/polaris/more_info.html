{% extends "./base.html" %} {% load i18n %} {% load tz %} {% load static %}

{% block "title" %}
<title>{% trans "Transaction More Info" %}</title>
{% endblock %}

{% block "content" %}
<section class="section receipt">
    {% if instructions is not none %}
    {# instructions came from Polaris' instructions_for_pending_deposit() #}
    <div class="info-item">
        <div class="info-label">
            {% trans "instructions" %}
        </div>
        <div class="field-value">
            {{ instructions|safe }}
        </div>
    </div>
    {% endif %}

    {# Instructions, if present, came from the anchor's more_info extension #}
    {# Note that the anchor's block must detect if instructions are necessary #}
    {# The anchor must determine the appropriate instructions (or none) from their own context #}

    {% block "instructions" %}
    {% endblock %}

    <div class="info-item">
        <div class="info-label">
            {% trans "kind" %}
        </div>
        <div class="field-value">
            {% if transaction.kind == "deposit" %}
                {% trans "deposit" %}
            {% else %}
                {% trans "withdrawal" %}
            {% endif %}
        </div>
    </div>

    <div class="info-item">
        <div class="info-label">
            {% trans "ID" %}
        </div>
        <div class="field-value">
            {{ transaction.id }}
        </div>
    </div>

    <div class="info-item">
        <div class="info-label">
            {% if transaction.status == "incomplete" or transaction.status == "pending_user_transfer_start" %}
              {% trans "amount to be received" %}
            {% else %}
              {% trans "amount received" %}
            {% endif %}
        </div>
        <div class="field-value">
            {{ amount_in }}
        </div>
    </div>

    <div class="info-item">
        <div class="info-label">
            {% trans "fee" %}
        </div>
        <div class="field-value">
            {{ amount_fee }}
        </div>
    </div>

    <div class="info-item">
        <div class="info-label">
            {% if transaction.kind == "deposit" %}
                {% if transaction.status != "completed" and transaction.amount_out %}
                    {% trans "amount to be deposited" %}
                {% else %}
                    {% trans "amount deposited" %}
                {% endif %}
            {% else %}
                {% if transaction.status != "completed" and transaction.amount_out %}
                    {% trans "amount to be withdrawn" %}
                {% else %}
                    {% trans "amount withdrawn" %}
                {% endif %}
            {% endif %}
        </div>
        <div class="field-value">
            {{ amount_out }}
        </div>
    </div>

    <div class="info-item">
        <div class="info-label">
            {% trans "status" %}
        </div>
        <div class="field-value">
            {{ transaction.message }}
        </div>
    </div>

    <div class="info-item">
        <div class="info-label">
            {% trans "start" %}
        </div>
        <div class="field-value">
            {{ transaction.started_at|localtime }}
        </div>
    </div>

    {% if transaction.status == "completed" %}
        <div class="info-item">
            <div class="info-label">
                {% trans "completed" %}
            </div>
            <div class="field-value">
                {{ transaction.completed_at|localtime }}
            </div>
        </div>
    {% endif %}

    <script type="text/javascript" src="{% static 'polaris/scripts/callback.js' %}"></script>
    <script type="text/javascript">
        callback({
            txJSON: '{{ tx_json|safe }}',
            onChangeCallback: '{{ transaction.on_change_callback }}',
            transactionStatus: '{{ transaction.status }}',
            callback: '{{ callback|safe }}'
        })
    </script>
</section>
{% endblock %}
